---
layout:     post
title:      n1 u盘启动openwrt做主路由拨号上网
subtitle:   
date:       2019-11-05 13:22:29
author:     "jkdigger"
header-img: 
catalog: true
tags:
    - n1刷机
---

> 优点：通过u盘启动openwrt路由系统有个明显的优点，可以保留n1原系统。
>
> 缺点：不稳定


### 1. 将openwrt固件写入u盘

- 固件：选择橙子固件
- 写入工具：`USB Image Tool`

### 2. 初始化设置

#### 01 用网线连接n1和电脑

- 浏览器中输入192.168.10.1，登入op系统

```
用户名 root
密码 password
```

- 网络->无线->基本设置

```
这里可以选 2.4G 或者 5G（只能二选一），模式目前只支持 legacy，注意信道不能选自动（随便选个信道即可），否则会没有 wifi 信号。最后点击保存应用。比如

工作频率：legacy、5g、36（5180MHZ）
```

- 点击[保存应用]

#### 02 拔掉电脑网线，电脑连n1wifi

- wifi名为OpenWrt

- 浏览器中输入192.168.10.1，登入op系统

```
用户名 root
密码 password
```

- 网络->接口->修改LAN->物理设置

```
取消eth0接口，点击保存

注意：不要点应用
```

- 回到接口主界面，新建一个WAN口

```
名称：WAN
协议：PPPoE
勾选eth0
```

- 点提交，在基本设置中输入宽带帐号，保存

```
PAP用户名：
PAP密码：
```

- 接口->WAN->防火墙设置

```
勾选第三个  WAN（空）
```

- 保存

#### 03 用网线连接n1和光猫

- 点击网络->接口
- [VPN WAN LAN]界面：点击三个[WAN] -[连接]
- 获取到ip，拨号成功
- 网络->防火墙->自定义规则，复制下面这一段

```
iptables -t nat -I POSTROUTING -j MASQUERADE
```

- 重启防火墙
- 网络->诊断->点击ping（可以ping通官网表示连接成功）
- 重启n1

#### 04 修改openwrt wifi密码

- 浏览器中输入192.168.10.1，登入op

```
用户名 root
密码 password
```

-  网络->无线 
-  ssid处，点击修改
-  接口配置：无线安全

```
加密方式 wpa2-psk
算法 自动
密码 自定义
```

- 保存并应用

### 参考资料

- [橙子固件下载]( https://www.maxlicheng.com/openwrt/216.html )
- [n1主路由设置]( https://www.maxlicheng.com/openwrt/51.html )